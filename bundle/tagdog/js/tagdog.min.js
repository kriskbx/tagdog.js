(function(){"use strict";var t=0,e=window.ontouchend?"touchend":"click",n={8:"backspace",13:"enter",188:","},i=Array.prototype.slice,r=Object.prototype.toString,a=function(t){return r.call(t).slice(8,-1)},o=function(t){return"String"===a(t)},s=function(t){return t instanceof HTMLElement},u=function(t){return"NodeList"===a(t)},h=function(t){return"Array"===a(t)},c=function(t){return i.call(t)},g=function(t,e){return t.indexOf(e)>-1},l=function(t,e){return(e||document).querySelector(t)},d=function(t,e){return(e||document).querySelectorAll(t)},p=function(t){var e,n,r,a=i.call(arguments,1),o=a.length;if(!o)return t;for(e=0;o>e;e++){r=a[e];for(n in r)t[n]=r[n]}return t},f=function(t){var e,i,r=this.hiddenInput.value,a=n[t.keyCode];if("enter"===a||","===a){if(t.preventDefault(),e=this.cleanTagName(this.originalInput.value),e.length<=0)return!1;g(this.currentTags,e)||this.addTag(e)}if("backspace"===a&&r.length>0){if(this.originalInput.value.length>0)return!1;i=d(".tagdog-tag",this.tagContainer),this.removeTag(i[i.length-1])}},v=function(t){t.preventDefault()},m=function(t){for(var e=t.target;"tagdog-tag"!==e.className;){if(e===this.tagContainer)return;e=e.parentNode}this.removeTag(e),this.originalInput.focus()},T=function(e,n){this.options=p({patterns:[{regex:/^\s+|\s+$/g},{regex:/[^a-z0-9 -]+/gi}],tooltipTitle:"Click to delete"},n),this.field=s(e)?e:l(e),this.field.classList.add("tagdog-field"),this.currentTags=[],this.originalInput=l("input",this.field),this.name=this.originalInput.getAttribute("name")||"tagdog_"+ ++t,this.hiddenInput=document.createElement("input"),this.hiddenInput.setAttribute("type","hidden"),this.hiddenInput.setAttribute("value",""),this.hiddenInput.setAttribute("name",this.name),this.tagContainer=document.createElement("div"),this.tagContainer.setAttribute("aria-hidden",!0),this.tagContainer.className="tagdog-container",this.field.appendChild(this.hiddenInput),this.field.insertBefore(this.tagContainer,this.originalInput)},y=function(){this.field.addEventListener("paste",v,!1),this.originalInput.addEventListener("keydown",f.bind(this),!1),this.tagContainer.addEventListener(e,m.bind(this),!1)},C=function(){var t=this.originalInput,e=(t.getAttribute("value")||"").split(",");e.forEach(function(t){this.addTag(t)},this),t.removeAttribute("name")},I=function A(t,e){return this instanceof A?(T.call(this,t,e),y.call(this),void C.call(this)):new A(t,e)};I.prototype.cleanTagName=function(t){return this.options.patterns.reduce(function(t,e){return t.replace(e.regex,e.replace||"")},t)},I.prototype.hasTag=function(t){var e=s(t)?t.textContent:t;return g(this.currentTags,e)},I.prototype.createTag=function(t,e){var n=e?t:this.cleanTagName(t),i=document.createElement("span");return i.textContent=n,i.setAttribute("aria-hidden",!0),i.setAttribute("role","button"),i.setAttribute("data-title",this.options.tooltipTitle),i.className="tagdog-tag",i},I.prototype.insertTagElement=function(t,e){return!e&&this.hasTag(t.textContent)?null:(t.classList.add("tagdog-tag"),this.currentTags.push(t.textContent),this.tagContainer.appendChild(t),this.hiddenInput.value=this.currentTags.join(","),this.originalInput.value="",t)},I.prototype.addTag=function(t){return o(t)&&t.trim()&&!this.hasTag(t)?this.insertTagElement(this.createTag(t)):null},I.prototype.removeTagByName=function(t){var e,n,i=c(d(".tagdog-tag",this.tagContainer)),r=i.length;for(this.currentTags.splice(this.currentTags.indexOf(t),1),this.hiddenInput.value=this.currentTags.join(",");r>0;)if(e=i[--r],e.textContent===n)return n=this.tagContainer.removeChild(e),removed;return null},I.prototype.removeTagByElement=function(t){this.currentTags.splice(this.currentTags.indexOf(t.textContent),1),this.hiddenInput.value=this.currentTags.join(",");var e=this.tagContainer.removeChild(t);return e},I.prototype.removeTag=function(t){return"string"==typeof t?this.removeTagByName(t):this.removeTagByElement(t)},I.prototype.getTags=function(t){return t?this.toLower(this.currentTags):this.currentTags},I.prototype.resetTags=function(){this.originalInput.setAttribute("value",""),this.hiddenInput.setAttribute("value",""),this.tagContainer.innerHTML="",this.currentTags.splice(0,this.currentTags.length)},I.prototype.toLower=function(t){return o(t)||h(t)?String(t).toLowerCase():""},I.prototype.isHTMLElement=s,I.prototype.isNodeList=u;var b=function(t,e){var n=function i(t,n){return this instanceof i?(I.apply(this,arguments),void(e&&p(this,e))):new i(t,n)};return n.prototype=p(I.prototype,t),n.prototype.constructor=I.prototype.constructor,n};this.tagdog=function E(t,e,n,i){if(!t)return E(".tagdog-field",e,n,i);if(s(t))return n||i?b(n,i)(t,e):new I(t,e);if(o(t)){var r=d(t),a=r.length;return a?(t=a>1?r:r[0],E(t,e,n,i)):null}return u(t)?(t=c(t),t.reduce(function(t,r){var a=E(r,e,n,i);return t[a.name]=a,t},{})):void 0}}).call(this);
//# sourceMappingURL=source-maps/tagdog.min.js.map
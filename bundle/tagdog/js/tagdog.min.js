(function(){"use strict";var t=0,e=window.ontouchend?"touchend":"click",n={8:"backspace",13:"enter",188:","},i=Array.prototype.slice,r=Object.prototype.toString,a=function(t){return r.call(t).slice(8,-1)},s=function(t){return"String"===a(t)},o=function(t){return t instanceof HTMLElement},u=function(t){return"NodeList"===a(t)},h=function(t){return"Array"===a(t)},g=function(t){return i.call(t)},c=function(t,e){return t.indexOf(e)>-1},l=function(t,e){return(e||document).querySelector(t)},p=function(t,e){return(e||document).querySelectorAll(t)},d=function(t){var e,n,r=i.call(arguments,1),a=r.length,s=0;if(!a)return t;for(;a>s;s++){n=r[s];for(e in n)t[e]=n[e]}return t},f=function(t){var e,i,r=this.hiddenInput.value,a=n[t.keyCode];if("enter"===a||","===a){if(t.preventDefault(),e=this.ensureMaxLength(this.originalInput.value),e.length<=0)return!1;c(this.currentTags,e)||this.addTag(e)}if("backspace"===a&&r.length>0){if(this.originalInput.value.length>0)return!1;i=p(".tagdog-tag",this.tagContainer),this.removeTag(i[i.length-1])}},m=function(t){t.preventDefault()},v=function(t){for(var e=t.target;"tagdog-tag"!==e.className;){if(e===this.tagContainer)return;e=e.parentNode}this.removeTag(e),this.originalInput.focus()},T=function(e,n){this.options=d({patterns:[{regex:/^\s+|\s+$/g},{regex:/[^a-z0-9 -]+/gi}],tooltipTitle:"Click to delete",maxLength:255,maxTags:12},n),this.field=o(e)?e:l(e),this.field.classList.add("tagdog-field"),this.currentTags=[],this.originalInput=l("input",this.field),this.name=this.originalInput.getAttribute("name")||"tagdog_"+ ++t,this.hiddenInput=document.createElement("input"),this.hiddenInput.setAttribute("type","hidden"),this.hiddenInput.setAttribute("value",""),this.hiddenInput.setAttribute("name",this.name),this.tagContainer=document.createElement("div"),this.tagContainer.setAttribute("aria-hidden",!0),this.tagContainer.className="tagdog-container",this.field.appendChild(this.hiddenInput),this.field.insertBefore(this.tagContainer,this.originalInput)},y=function(){this.field.addEventListener("paste",m,!1),this.originalInput.addEventListener("keydown",f.bind(this),!1),this.tagContainer.addEventListener(e,v.bind(this),!1)},C=function(){var t=this.originalInput,e=t.getAttribute("value"),n=this.options.maxTags;e&&(e.split(/,\s*/,n).forEach(function(t){t=this.ensureMaxLength(t),this.addTag(t)},this),t.removeAttribute("name"))},x=function b(t,e){return this instanceof b?(this.events={},T.call(this,t,e),y.call(this),void C.call(this)):new b(t,e)};x.prototype.cleanTagName=function(t){return t=this.ensureMaxLength(t),this.options.patterns.reduce(function(t,e){return t.replace(e.regex,e.replace||"")},t)},x.prototype.createTagElement=function(t,e){var n;return this.hasTag(t)?null:(n=document.createElement("span"),n.textContent=e?t:this.cleanTagName(t),n.setAttribute("aria-hidden",!0),n.setAttribute("role","button"),n.setAttribute("data-title",this.options.tooltipTitle),n.className="tagdog-tag",n)},x.prototype.insertTagElement=function(t,e){var n;return!e&&this.hasTag(t.textContent)?null:this.isMaxTags()?null:(t.classList.add("tagdog-tag"),n=t.textContent,this.currentTags.push(n),this.tagContainer.appendChild(t),this.hiddenInput.value=this.currentTags.join(","),this.originalInput.value="",this.emit("taginserted",{type:"taginserted",srcName:this.name,srcElement:this.field,currentTags:this.getTags(),tagElement:t,tagName:n,timestamp:Date.now()}),t)},x.prototype.addTag=function(t){var e=o(t)?t:this.createTagElement(t);return this.insertTagElement(e)},x.prototype.addTags=function(){var t=i.call(arguments);return t.map(function(t){return h(t)?this.addTags.apply(this,t):this.addTag(t)},this)},x.prototype.hasTag=function(t){var e=o(t)?t.textContent:t;return e=this.ensureMaxLength(e),c(this.currentTags,e)},x.prototype.removeTagByName=function(t){var e,n,i=g(p(".tagdog-tag",this.tagContainer)),r=i.length;for(this.currentTags.splice(this.currentTags.indexOf(t),1),this.hiddenInput.value=this.currentTags.join(",");r>0;)if(e=i[--r],e.textContent===n)return n=this.tagContainer.removeChild(e),this.emit("tagremoved",{type:"tagremoved",srcName:this.name,srcElement:this.field,currentTags:this.getTags(),tagElement:n,tagName:n.textContent,timestamp:Date.now()}),removed;return null},x.prototype.removeTagByElement=function(t){this.currentTags.splice(this.currentTags.indexOf(t.textContent),1),this.hiddenInput.value=this.currentTags.join(",");var e=this.tagContainer.removeChild(t);return this.emit("tagremoved",{type:"tagremoved",srcName:this.name,srcElement:this.field,currentTags:this.getTags(),tagElement:e,tagName:e.textContent,timestamp:Date.now()}),e},x.prototype.removeTag=function(t){return"string"==typeof t?this.removeTagByName(t):this.removeTagByElement(t)},x.prototype.getTags=function(t){return t?this.toLower(this.currentTags):this.currentTags},x.prototype.resetTags=function(){this.originalInput.setAttribute("value",""),this.hiddenInput.setAttribute("value",""),this.tagContainer.innerHTML="",this.currentTags.splice(0,this.currentTags.length),this.emit("fieldreset",{type:"fieldreset",srcName:this.name,srcElement:this.field,timestamp:Date.now()})},x.prototype.isMaxTags=function(){return this.getTags().length>=this.options.maxTags},x.prototype.toLower=function(t){return s(t)||h(t)?String(t).toLowerCase():""},x.prototype.ensureMaxLength=function(t){var e=this.options.maxLength;return t>=e?t:t.substring(0,e)},x.prototype.isHTMLElement=o,x.prototype.isNodeList=u,x.prototype.createTag=x.prototype.createTagElement,x.prototype.on=function(t,e){var n=this.events;n[t]=n[t]||[],n[t].push(e)},x.prototype.off=function(t,e){var n,i,r=this.events;if(r[t])for(n=0,i=r[t].length;i>n;n++)if(r[t][n]===e){r[t].splice(n,1);break}},x.prototype.once=function(t,e){var n=this,i=(this.events,function r(i){e(i),n.off(t,r)});this.on(t,i)},x.prototype.emit=function(t,e){var n,i,r,a=this.events;if(a[t])for(i=0,r=a[t].length;r>i;i++)n=a[t][i],n&&n(e||{})},x.prototype.hasEvents=function(){var t,e=this.events;for(t in e)if(e[t]&&e[t].length)return!0;return!1};var E=function(t,e){var n=function i(t,n){return this instanceof i?(x.apply(this,arguments),void(e&&d(this,e))):new i(t,n)};return n.prototype=d(x.prototype,t),n.prototype.constructor=x.prototype.constructor,n};this.tagdog=function I(t,e,n,i){if(!t)return I(".tagdog-field",e,n,i);if(o(t))return n||i?E(n,i)(t,e):new x(t,e);if(s(t)){var r=p(t),a=r.length;return a?(t=a>1?r:r[0],I(t,e,n,i)):null}return u(t)?(t=g(t),t.reduce(function(t,r){var a=I(r,e,n,i);return t[a.name]=a,t},{})):void 0}}).call(this);
//# sourceMappingURL=source-maps/tagdog.min.js.map

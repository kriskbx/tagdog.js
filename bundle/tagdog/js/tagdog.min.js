(function(){"use strict";var t=0,e=window.ontouchend?"touchend":"click",n={8:"backspace",13:"enter",188:","},i=Array.prototype.slice,r=Object.prototype.toString,a=function(t){return r.call(t).slice(8,-1)},o=function(t){return"String"===a(t)},s=function(t){return t instanceof HTMLElement},u=function(t){return"NodeList"===a(t)},h=function(t){return"Array"===a(t)},g=function(t){return i.call(t)},l=function(t,e){return t.indexOf(e)>-1},c=function(t,e){return(e||document).querySelector(t)},d=function(t,e){return(e||document).querySelectorAll(t)},p=function(t){var e,n,r,a=i.call(arguments,1),o=a.length;if(!o)return t;for(e=0;o>e;e++){r=a[e];for(n in r)t[n]=r[n]}return t},f=function(t){var e,i,r=this.hiddenInput.value,a=n[t.keyCode];if("enter"===a||","===a){if(t.preventDefault(),e=this.cleanTagName(this.originalInput.value),e.length<=0)return!1;l(this.currentTags,e)||this.addTag(e)}if("backspace"===a&&r.length>0){if(this.originalInput.value.length>0)return!1;i=d(".tagdog-tag",this.tagContainer),this.removeTag(i[i.length-1])}},m=function(t){t.preventDefault()},T=function(t){for(var e=t.target;"tagdog-tag"!==e.className;){if(e===this.tagContainer)return;e=e.parentNode}this.removeTag(e),this.originalInput.focus()},v=function(e,n){this.extend=p,n=this.extend({patterns:[{regex:/^\s+|\s+$/g},{regex:/[^a-z0-9 -]+/gi}],tooltipTitle:"Click to delete"},n),this.patterns=n.patterns,this.tooltipTitle=n.tooltipTitle,this.element=e||c(".tagdog-field"),this.element.classList.add("tagdog-field"),this.currentTags=[],this.originalInput=c("input",this.element),this.name=this.originalInput.getAttribute("name")||"tagdog_"+ ++t,this.hiddenInput=document.createElement("input"),this.hiddenInput.setAttribute("type","hidden"),this.hiddenInput.setAttribute("value",""),this.hiddenInput.setAttribute("name",this.name),this.tagContainer=document.createElement("div"),this.tagContainer.setAttribute("aria-hidden",!0),this.tagContainer.className="tagdog-container",this.element.appendChild(this.hiddenInput),this.element.insertBefore(this.tagContainer,this.originalInput)},y=function(){this.element.addEventListener("paste",m,!1),this.originalInput.addEventListener("keydown",f.bind(this),!1),this.tagContainer.addEventListener(e,T.bind(this),!1)},C=function(){var t=this.originalInput,e=(t.getAttribute("value")||"").split(",");e.forEach(function(t){this.addTag(t)},this),t.removeAttribute("name")},I=function b(t,e){return this instanceof b?(v.call(this,t,e),y.call(this),void C.call(this)):new b(t,e)};I.prototype.cleanTagName=function(t){return this.patterns.reduce(function(t,e){return t.replace(e.regex,e.replace||"")},t)},I.prototype.hasTag=function(t){var e="object"==typeof t?t.textContent:t;return l(this.currentTags,e)},I.prototype.createTag=function(t,e){var n=e?t:this.cleanTagName(t),i=document.createElement("span");return i.textContent=n,i.setAttribute("aria-hidden",!0),i.setAttribute("role","button"),i.setAttribute("data-title",this.tooltipTitle),i.className="tagdog-tag",i},I.prototype.insertTagElement=function(t,e){return!e&&this.hasTag(t.textContent)?null:(t.classList.add("tagdog-tag"),this.currentTags.push(t.textContent),this.tagContainer.appendChild(t),this.hiddenInput.value=this.currentTags.join(","),this.originalInput.value="",t)},I.prototype.addTag=function(t){return o(t)&&t.trim()&&!this.hasTag(t)?this.insertTagElement(this.createTag(t)):null},I.prototype.removeTagByName=function(t){var e,n,i=g(d(".tagdog-tag",this.tagContainer)),r=i.length;for(this.currentTags.splice(this.currentTags.indexOf(t),1),this.hiddenInput.value=this.currentTags.join(",");r>0;)if(e=i[--r],e.textContent===n)return n=this.tagContainer.removeChild(e),removed;return null},I.prototype.removeTagByElement=function(t){this.currentTags.splice(this.currentTags.indexOf(t.textContent),1),this.hiddenInput.value=this.currentTags.join(",");var e=this.tagContainer.removeChild(t);return e},I.prototype.removeTag=function(t){return"string"==typeof t?this.removeTagByName(t):this.removeTagByElement(t)},I.prototype.getTags=function(t){return t?this.toLower(this.currentTags):this.currentTags},I.prototype.resetTags=function(){this.originalInput.setAttribute("value",""),this.hiddenInput.setAttribute("value",""),this.tagContainer.innerHTML="",this.currentTags.splice(0,this.currentTags.length)},I.prototype.toLower=function(t){return o(t)||h(t)?String(t).toLowerCase():""},I.prototype.isHTMLElement=s,I.prototype.isNodeList=u,this.tagdog=function A(t,e){if(!t)return A(".tagdog-field",e);if(s(t))return new I(t,e);if(o(t)){var n=d(t),i=n.length;return i?i>1?A(n,e):A(n[0],e):null}return u(t)?(t=g(t),t.reduce(function(t,n){var i=A(n,e);return t[i.name]=i,t},{})):void 0}}).call(this);
//# sourceMappingURL=source-maps/tagdog.min.js.map
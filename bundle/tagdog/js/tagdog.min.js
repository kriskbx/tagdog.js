(function(){"use strict";var t=0,e=window.ontouchend?"touchend":"click",n={8:"backspace",13:"enter",188:","},i=Array.prototype.slice,r=Object.prototype.toString,a=function(t){return r.call(t).slice(8,-1)},o=function(t){return"String"===a(t)},s=function(t){return t instanceof HTMLElement},u=function(t){return"NodeList"===a(t)},h=function(t){return"Array"===a(t)},g=function(t){return i.call(t)},c=function(t,e){return t.indexOf(e)>-1},l=function(t,e){return(e||document).querySelector(t)},d=function(t,e){return(e||document).querySelectorAll(t)},p=function(t){var e,n,r,a=i.call(arguments,1),o=a.length;if(!o)return t;for(e=0;o>e;e++){r=a[e];for(n in r)t[n]=r[n]}return t},f=function(t){var e,i,r=this.hiddenInput.value,a=n[t.keyCode];if("enter"===a||","===a){if(t.preventDefault(),e.length<=0)return!1;e=this.ensureMaxLength(this.originalInput.value),c(this.currentTags,e)||this.addTag(e)}if("backspace"===a&&r.length>0){if(this.originalInput.value.length>0)return!1;i=d(".tagdog-tag",this.tagContainer),this.removeTag(i[i.length-1])}},v=function(t){t.preventDefault()},m=function(t){for(var e=t.target;"tagdog-tag"!==e.className;){if(e===this.tagContainer)return;e=e.parentNode}this.removeTag(e),this.originalInput.focus()},T=function(t,e){if(document.createEvent){var n=document.createEvent("HTMLEvents");n.initEvent(e,!0,!1),t.dispatchEvent(n)}else t.fireEvent(e)},y=function(e,n){this.options=p({patterns:[{regex:/^\s+|\s+$/g},{regex:/[^a-z0-9 -]+/gi}],tooltipTitle:"Click to delete",maxLength:255,maxTags:12},n),this.field=s(e)?e:l(e),this.field.classList.add("tagdog-field"),this.currentTags=[],this.originalInput=l("input",this.field),this.name=this.originalInput.getAttribute("name")||"tagdog_"+ ++t,this.hiddenInput=document.createElement("input"),this.hiddenInput.setAttribute("type","hidden"),this.hiddenInput.setAttribute("value",""),this.hiddenInput.setAttribute("name",this.name),this.tagContainer=document.createElement("div"),this.tagContainer.setAttribute("aria-hidden",!0),this.tagContainer.className="tagdog-container",this.field.appendChild(this.hiddenInput),this.field.insertBefore(this.tagContainer,this.originalInput)},C=function(){this.field.addEventListener("paste",v,!1),this.originalInput.addEventListener("keydown",f.bind(this),!1),this.tagContainer.addEventListener(e,m.bind(this),!1)},x=function(){var t=this.originalInput,e=t.getAttribute("value");e&&(e.split(",").forEach(function(t){t=this.ensureMaxLength(t),this.addTag(t)},this),t.removeAttribute("name"))},E=function I(t,e){return this instanceof I?(y.call(this,t,e),C.call(this),void x.call(this)):new I(t,e)};E.prototype.cleanTagName=function(t){return t=this.ensureMaxLength(t),this.options.patterns.reduce(function(t,e){return t.replace(e.regex,e.replace||"")},t)},E.prototype.createTagElement=function(t,e){var n;return this.hasTag(t)?null:(n=document.createElement("span"),n.textContent=e?t:this.cleanTagName(t),n.setAttribute("aria-hidden",!0),n.setAttribute("role","button"),n.setAttribute("data-title",this.options.tooltipTitle),n.className="tagdog-tag",n)},E.prototype.insertTagElement=function(t,e){return!e&&this.hasTag(t.textContent)?null:this.isMaxTags()?null:(t.classList.add("tagdog-tag"),this.currentTags.push(t.textContent),this.tagContainer.appendChild(t),this.hiddenInput.value=this.currentTags.join(","),this.originalInput.value="",T(this.field,"change"),t)},E.prototype.addTag=function(t){var e=s(t)?t:this.createTagElement(t);return this.insertTagElement(e)},E.prototype.hasTag=function(t){var e=s(t)?t.textContent:t;return e=this.ensureMaxLength(e),c(this.currentTags,e)},E.prototype.removeTagByName=function(t){var e,n,i=g(d(".tagdog-tag",this.tagContainer)),r=i.length;for(this.currentTags.splice(this.currentTags.indexOf(t),1),this.hiddenInput.value=this.currentTags.join(",");r>0;)if(e=i[--r],e.textContent===n)return n=this.tagContainer.removeChild(e),T(this.field,"change"),removed;return null},E.prototype.removeTagByElement=function(t){this.currentTags.splice(this.currentTags.indexOf(t.textContent),1),this.hiddenInput.value=this.currentTags.join(",");var e=this.tagContainer.removeChild(t);return T(this.field,"change"),e},E.prototype.removeTag=function(t){return"string"==typeof t?this.removeTagByName(t):this.removeTagByElement(t)},E.prototype.getTags=function(t){return t?this.toLower(this.currentTags):this.currentTags},E.prototype.resetTags=function(){this.originalInput.setAttribute("value",""),this.hiddenInput.setAttribute("value",""),this.tagContainer.innerHTML="",this.currentTags.splice(0,this.currentTags.length),T(this.field,"change")},E.prototype.isMaxTags=function(){return this.getTags().length>=this.options.maxTags},E.prototype.toLower=function(t){return o(t)||h(t)?String(t).toLowerCase():""},E.prototype.ensureMaxLength=function(t){var e=this.options.maxLength;return t>=e?t:t.substring(0,e)},E.prototype.isHTMLElement=s,E.prototype.isNodeList=u,E.prototype.createTag=E.prototype.createTagElement;var L=function(t,e){var n=function i(t,n){return this instanceof i?(E.apply(this,arguments),void(e&&p(this,e))):new i(t,n)};return n.prototype=p(E.prototype,t),n.prototype.constructor=E.prototype.constructor,n};this.tagdog=function b(t,e,n,i){if(!t)return b(".tagdog-field",e,n,i);if(s(t))return n||i?L(n,i)(t,e):new E(t,e);if(o(t)){var r=d(t),a=r.length;return a?(t=a>1?r:r[0],b(t,e,n,i)):null}return u(t)?(t=g(t),t.reduce(function(t,r){var a=b(r,e,n,i);return t[a.name]=a,t},{})):void 0}}).call(this);
//# sourceMappingURL=source-maps/tagdog.min.js.map
